# 性能测试记录

## 04c1fdd87a2b7c994ac1473fd54a208e553aa7ab

支持分段输入

|              Method |                 text | time |          Mean |         Error |        StdDev |      Gen0 |      Gen1 |     Gen2 |  Allocated |
|-------------------- |--------------------- |----- |--------------:|--------------:|--------------:|----------:|----------:|---------:|-----------:|
| AppendTextMultiTime |                  123 |   10 |     15.736 us |     0.2523 us |     0.2360 us |    2.8687 |         - |        - |   11.72 KB |
|    AppTextMultiLine |                  123 |   10 |     15.417 us |     0.2541 us |     0.2252 us |    3.9063 |         - |        - |   15.98 KB |
| AppendTextMultiTime |                  123 |  100 |    869.252 us |    12.0676 us |    10.6976 us |   26.3672 |    0.9766 |        - |  108.61 KB |
|    AppTextMultiLine |                  123 |  100 |    401.723 us |     5.6316 us |     5.2678 us |   36.1328 |    3.9063 |        - |  148.58 KB |
| AppendTextMultiTime |                  123 | 1000 | 84,483.027 us | 1,001.9454 us | 1,072.0703 us |  142.8571 |         - |        - | 1057.72 KB |
|    AppTextMultiLine |                  123 | 1000 | 35,232.253 us |   670.1005 us |   847.4626 us |  285.7143 |   71.4286 |        - | 1470.49 KB |
|          AppendText |                  123 |    ? |      1.060 us |     0.0187 us |     0.0208 us |    0.5569 |         - |        - |    2.28 KB |
|          AppendText |  1231(...)3123 [180] |    ? |     23.926 us |     0.4252 us |     0.3319 us |    8.6670 |    0.0305 |        - |    35.4 KB |
|            LongText | TTT(...)TTT [100000] |    ? | 46,909.785 us |   934.5071 us | 2,184.3803 us | 3090.9091 | 1363.6364 | 545.4545 | 18456.9 KB |

## 5f7166d4db81ed44bb0cb7dbe3c5355c63d34651

加上字符属性设置

|     Method |                 text |            Mean |         Error |          StdDev |      Gen0 |      Gen1 |     Gen2 |   Allocated |
|----------- |--------------------- |----------------:|--------------:|----------------:|----------:|----------:|---------:|------------:|
| AppendText |                  123 |        921.8 ns |      18.41 ns |        15.37 ns |    0.5398 |         - |        - |     2.21 KB |
| AppendText |  1231(...)3123 [180] |     21,564.7 ns |     224.42 ns |       187.40 ns |    8.6365 |         - |        - |    35.33 KB |
|   LongText | TTT(...)TTT [100000] | 44,904,371.4 ns | 786,198.08 ns | 1,335,024.01 ns | 3166.6667 | 1416.6667 | 583.3333 | 18457.13 KB |

## db955a8e03d4b258c31ed805233a1e3bd9527fd0

完成更多布局

一个字符需要申请 180 个 byte 的内存参与布局

|     Method |                 text |            Mean |         Error |        StdDev |      Gen0 |      Gen1 |     Gen2 |   Allocated |
|----------- |--------------------- |----------------:|--------------:|--------------:|----------:|----------:|---------:|------------:|
| AppendText |                  123 |        831.3 ns |      16.08 ns |      24.56 ns |    0.4835 |         - |        - |     1.98 KB |
| AppendText |  1231(...)3123 [180] |     20,579.6 ns |     186.36 ns |     145.50 ns |    8.5754 |    0.0305 |        - |    35.09 KB |
|   LongText | TTT(...)TTT [100000] | 43,049,424.4 ns | 854,221.60 ns | 799,039.41 ns | 3166.6667 | 1416.6667 | 583.3333 | 18456.66 KB |

## 7d4a19cc5eeb09a1fa34c2f83ed162b23c6e0734

对每个字符的布局节省一个数组的创建

|     Method |                 text |            Mean |         Error |        StdDev |      Gen0 |      Gen1 |     Gen2 |   Allocated |
|----------- |--------------------- |----------------:|--------------:|--------------:|----------:|----------:|---------:|------------:|
| AppendText |                  123 |        609.0 ns |      11.67 ns |       9.11 ns |    0.4129 |         - |        - |     1.69 KB |
| AppendText |  1231(...)3123 [180] |     15,231.1 ns |     294.33 ns |     289.07 ns |    6.1340 |         - |        - |    25.13 KB |
|   LongText | TTT(...)TTT [100000] | 25,938,670.8 ns | 414,858.20 ns | 388,058.62 ns | 2187.5000 | 1093.7500 | 500.0000 | 12987.59 KB |

## 2bb428e2d633a9eb4d8e8c0d9d7b2d52ff0d4d82

|     Method |                 text |            Mean |         Error |          StdDev |      Gen0 |      Gen1 |     Gen2 |   Allocated |
|----------- |--------------------- |----------------:|--------------:|----------------:|----------:|----------:|---------:|------------:|
| AppendText |                  123 |        669.4 ns |      13.38 ns |        23.79 ns |    0.4416 |         - |        - |      1.8 KB |
| AppendText |  1231(...)3123 [180] |     17,325.7 ns |     345.02 ns |       656.44 ns |    7.8735 |         - |        - |    32.16 KB |
|   LongText | TTT(...)TTT [100000] | 33,275,238.0 ns | 659,844.83 ns | 1,738,295.20 ns | 2866.6667 | 1400.0000 | 600.0000 | 16893.65 KB |

## 220f30a53feae9d4074ddacc0e11ca4b46700abb

将 Run 拆分为 CharData 之后

|     Method |                 text |            Mean |           Error |          StdDev |      Gen0 |      Gen1 |     Gen2 |   Allocated |
|----------- |--------------------- |----------------:|----------------:|----------------:|----------:|----------:|---------:|------------:|
| AppendText |                  123 |        608.4 ns |        11.47 ns |        18.85 ns |    0.4530 |         - |        - |     1.85 KB |
| AppendText |  1231(...)3123 [180] |     14,168.9 ns |       250.63 ns |       234.44 ns |    8.5602 |         - |        - |    34.97 KB |
|   LongText | TTT(...)TTT [100000] | 48,370,846.6 ns | 1,603,462.69 ns | 4,727,845.92 ns | 3363.6364 | 1545.4545 | 636.3636 | 18456.16 KB |

## 272620dbf0e1d7ea93184947e3e615cb8e5fb7b3

加上性能测试

|     Method |                 text |           Mean |         Error |        StdDev |      Gen0 |     Gen1 |     Gen2 |   Allocated |
|----------- |--------------------- |---------------:|--------------:|--------------:|----------:|---------:|---------:|------------:|
| AppendText |                  123 |       775.2 ns |      15.46 ns |      29.42 ns |    0.4854 |        - |        - |     1.98 KB |
| AppendText |  1231(...)3123 [180] |    12,467.0 ns |     193.32 ns |     206.85 ns |    5.8136 |        - |        - |    23.81 KB |
|   LongText | TTT(...)TTT [100000] | 9,823,145.3 ns | 194,569.12 ns | 224,066.09 ns | 2093.7500 | 921.8750 | 921.8750 | 11911.14 KB |