<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:viewModels="clr-namespace:SimpleWrite.ViewModels"
             xmlns:models="clr-namespace:SimpleWrite.Models"
             mc:Ignorable="d" d:DesignWidth="600" d:DesignHeight="25"
             x:Name="RootTabBar"
             x:Class="SimpleWrite.Views.Components.TabBar"
             x:DataType="viewModels:SimpleWriteMainViewModel"
             >
    <Design.DataContext>
        <viewModels:SimpleWriteMainViewModel/>
    </Design.DataContext>
    <Border x:Name="TabBarBorder" Background="#0E0E0E" BorderThickness="0,0,0,1" BorderBrush="#3D3D3D">
      <ListBox x:Name="EditorTabListBox" SelectionMode="Single" Background="Transparent" 
               ItemsSource="{Binding Path=EditorViewModel.EditorModelList}"
               SelectedItem="{Binding Path=EditorViewModel.CurrentEditorModel}">
          <ListBox.Styles>
              <Style Selector="Border.Tab-Main-Style">
                  <Setter Property="Background" Value="#1E1E1E" />
              </Style>
              <Style Selector="ListBoxItem:selected Border.Tab-Main-Style">
                  <Setter Property="Background" Value="#2E2E2E" />
                  <Setter Property="CornerRadius" Value="5 5 0 0"></Setter>
              </Style>
          </ListBox.Styles>
          <ListBox.ItemsPanel>
              <ItemsPanelTemplate>
                  <StackPanel x:Name="EditorTabStackPanel" Orientation="Horizontal"></StackPanel>
              </ItemsPanelTemplate>
          </ListBox.ItemsPanel>
          <ListBox.ItemContainerTheme>
              <ControlTheme TargetType="ListBoxItem">
                  <Setter Property="Margin" Value="0"></Setter>
              </ControlTheme>
          </ListBox.ItemContainerTheme>
          <ListBox.ItemTemplate>
              <DataTemplate DataType="models:EditorModel">
                  <Border x:Name="TabItemBorder" Classes="Tab-Main-Style" Margin="0,3,2,0" 
                          Padding="5,2,5,0"
                          >
                      <!-- 以下设置无效 -->
                      <!-- <Border.Styles> -->
                      <!--     <Style Selector="Border:selected"> -->
                      <!--         <Setter Property="Background" Value="Red" /> -->
                      <!--     </Style> -->
                      <!-- </Border.Styles> -->

                      <!-- 每个标签的部分 -->
                      <Border.ContextMenu>
                          <ContextMenu x:Name="TabItemContextMenu">
                              <MenuItem x:Name="OpenInFileExplorerMenuItem" Header="在文件资源管理器中打开" Click="OpenInFileExplorerMenuItem_OnClick" />
                          </ContextMenu>
                      </Border.ContextMenu>
                      <StackPanel Orientation="Horizontal">
                          <TextBlock x:Name="TabTitleTextBlock" Text="{Binding Title}" Foreground="White"
                                     ToolTip.Tip="{Binding FileInfo.FullName}"></TextBlock>
                          <Button x:Name="CloseTabButton" Margin="5 0 0 0" Background="Transparent" Padding="0"
                                  Foreground="White"
                                  VerticalAlignment="Center" Click="CloseTabButton_OnClick">
                              <Path Stroke="{Binding #CloseTabButton.Foreground}" StrokeThickness="2" Data="M0,0 L6,6z M6,0 L0,6"></Path>
                          </Button>
                      </StackPanel>
                  </Border>
                </DataTemplate>
          </ListBox.ItemTemplate>
      </ListBox>
    </Border>
</UserControl>
